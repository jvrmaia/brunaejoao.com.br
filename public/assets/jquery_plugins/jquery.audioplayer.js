function jQueryAudioPlayer(e,t){this.options=jQuery.extend({},jQueryAudioPlayer.DEFAULTS,t||{}),this.element=e}jQuery.fn.audioPlayer=function(e,t,o){return"string"!=typeof e&&(e=e||{},this.each(function(t,o){o.audioPlayer=new jQueryAudioPlayer(jQuery(o),e),o.audioPlayer.init()})),this},jQueryAudioPlayer.instances||(jQueryAudioPlayer.instances={}),window.jQueryAudioPlayer||(window.jQueryAudioPlayer=function(e){return jQueryAudioPlayer.instances[e]}),jQueryAudioPlayer.prototype._loadPlaylist=function(){var e=this;this.options.playlistUrl&&""!=this.options.playlistUrl?$.ajax({url:this.options.playlistUrl,type:"GET",dataType:"json",success:function(t,o){t?(e.playlist=t,e._playlistLoaded(!0)):e._playlistLoaded(!1)},error:function(){e._playlistLoaded(!1)}}):e.options.playlist&&""!=e.options.playlist?(e.playlist=JSON.parse(this.options.playlist),e._playlistLoaded(!0)):e.options.element&&e.options.element&&(e.playlist=[],$(e.options.element).each(function(){var t=$(this).attr("album"),o=$(this).attr("artist"),a=$(this).attr("title"),n=$(this).attr("href");e.playlist.push({file:n,artist:o,album:t,title:a})}),e._playlistLoaded(!0))},jQueryAudioPlayer.prototype._setInfo=function(e){var t="";this.playlist[e].artist&&""!=this.playlist[e].artist&&(t+=this.playlist[e].artist);var o="";this.playlist[e].title&&""!=this.playlist[e].title&&(o=this.playlist[e].title),this.element.find(".artist-str").html("<span></span>"+t),this.element.find(".title-str").html("<span></span>"+o),this.element.find(".current-track").html(this.current+1)},jQueryAudioPlayer.prototype.gotoNext=function(){++this.current>=this.playlist.length&&(this.current=0),this.play("next")},jQueryAudioPlayer.prototype.gotoPrevious=function(){--this.current<0&&(this.current=this.playlist.length-1),this.play("prev")},jQueryAudioPlayer.prototype.pause=function(){this._pause(),this.stoped=!1,this.paused=!0,this.playButton.removeClass("pause").addClass("play"),this._dispatchOnPause()},jQueryAudioPlayer.prototype.stop=function(){this._stop(),this.current=0,this.stoped=!0,this.paused=!1,this.playButton.removeClass("pause").addClass("play"),this._setLoadedProgress(0),this._setTimeProgress(0),this._dispatchOnStop()},jQueryAudioPlayer.prototype.play=function(e){(!this.paused||e)&&(this._src(this.playlist[this.current].file),this._setLoadedProgress(100),this.element.find(".artist-str").html(this.options.loadingStr),this.element.find(".title-str").html(this.options.loadingStr),this.playing_track=this.current,this.element.find(".current-track").html(this.current+1)),this.paused&&e?(this._load(),this._setInfo(this.current)):(this._play(),this.stoped=!1,this.paused=!1,this.playButton.removeClass("play").addClass("pause"),this._dispatchOnPlay()),this.options.pauseaE()},jQueryAudioPlayer.prototype.askToPlay=function(){var e=this;Boxy.ask(this.options.askStr,this.options.askBtns,function(t){t==e.options.askBtns[0]?e.play():((navigator.userAgent.match(/iphone/i)||navigator.userAgent.match(/android/i))&&$("#music").hide(),e._setInfo(e.current))},{title:this.options.askTitleStr})},jQueryAudioPlayer.prototype._playlistLoaded=function(e){e?(this.total=this.playlist.length,this.element.find(".total-tracks").html(this.total),this.current=0,this.paused=!1,this.stoped=!0,this.element.find(".artist-str").html(""),this.element.find(".title-str").html(""),this.options.autoPlay?1==this.options.askToPlay||navigator.userAgent.match(/iphone/i)||navigator.userAgent.match(/ipad/i)||navigator.userAgent.match(/ipod/i)||navigator.userAgent.match(/android/i)?this.askToPlay():this.play():this._setInfo(this.current)):console.error("playlist not loaded")},jQueryAudioPlayer.prototype._checkSupport=function(){if(this.options.onlyMobile&&!(navigator.userAgent.match(/ipod/i)||navigator.userAgent.match(/iphone/i)||navigator.userAgent.match(/ipad/i)||navigator.userAgent.match(/android/i)))return!1;try{if(!this.audioElement||!this.audioElement.canPlayType)return!1;var e=this.audioElement.canPlayType("audio/mp3");if("maybe"!=e&&"probably"!=e){var e=this.audioElement.canPlayType("audio/mpeg");if("maybe"!=e&&"probably"!=e)return!1}}catch(t){return!1}return!0},jQueryAudioPlayer.prototype._dispatchOnNotSupport=function(){this.options.onNotSupport&&this.options.onNotSupport.call(this)},jQueryAudioPlayer.prototype._dispatchOnPause=function(){this.options.onPause&&this.options.onPause.call(this)},jQueryAudioPlayer.prototype._dispatchOnStop=function(){this.options.onStop&&this.options.onStop.call(this)},jQueryAudioPlayer.prototype._dispatchOnPlay=function(){this.options.onPlay&&this.options.onPlay.call(this)},jQueryAudioPlayer.prototype._setLoadedProgress=function(e){var t=this.controls.find(".seeker").width(),o=t*e/100;this.controls.find(".loaded").css("width",o+"px")},jQueryAudioPlayer.prototype._setTimeProgress=function(e){var t=this.controls.find(".seeker").width(),o=t*e/100;this.controls.find(".progress").css("width",o+"px")},jQueryAudioPlayer.prototype._volumeAdjustment=function(){var e=100*this._getVolume(),t=this.controls.find(".volume").width(),o=t*e/100;this.controls.find(".volume-progress").css("width",o+"px")},jQueryAudioPlayer.prototype._getParameters=function(){var e={movieName:this.movieName,volume:this.options.volume};return e},jQueryAudioPlayer.prototype._getFlashObject=function(){var e=null;if("function"==typeof document[this.movieName].playSound?e=document[this.movieName]:"function"==typeof window[this.movieName].playSound&&(e=window[this.movieName]),!e)throw"Invalid flash object";return e},jQueryAudioPlayer.prototype._setVolume=function(e){if(this.audioElement)this.audioElement.volume=e;else{var t=this._getFlashObject();if(t)try{t.setVolume(e)}catch(o){}}this._volumeAdjustment()},jQueryAudioPlayer.prototype._getVolume=function(){if(this.audioElement)return this.audioElement.volume;var e=this._getFlashObject();if(e)try{return e.getVolume()}catch(t){}return 0},jQueryAudioPlayer.prototype._play=function(){if(this.audioElement)this.audioElement.play();else{var e=this._getFlashObject();if(e)try{e.playSound()}catch(t){}}},jQueryAudioPlayer.prototype._pause=function(){if(this.audioElement)this.audioElement.pause();else{var e=this._getFlashObject();if(e)try{e.pauseSound()}catch(t){}}},jQueryAudioPlayer.prototype._stop=function(){if(this.audioElement)this.audioElement.src=this.playlist[this.current].file,this.audioElement.pause();else{var e=this._getFlashObject();if(e){e.setSrc(this.playlist[this.current].file);try{e.stopSound()}catch(t){}}}},jQueryAudioPlayer.prototype._load=function(){if(this.audioElement)this.audioElement.load();else{var e=this._getFlashObject();if(e)try{e.loadSound()}catch(t){}}},jQueryAudioPlayer.prototype._src=function(e){if(this.audioElement)this.audioElement.src=e;else{var t=this._getFlashObject();if(t)try{t.setSrc(e)}catch(o){}}},jQueryAudioPlayer.prototype.initFlashFallback=function(){this.audioElement=null,this.movieName="jQueryAudioPlayer"+this.element.attr("id");var e=$('<div><div class="flash"></div></div>'),t=e.find(".flash");t.attr("id",this.movieName),e.css("width","1px"),e.css("height","1px"),e.css("overflow","hidden"),e.css("position","absolute"),this.element.prepend(e),jQueryAudioPlayer.instances[this.movieName]=this;var o=this.options.basePath+"/audioplayer.swf?random="+Math.random()+"&timestamp="+(new Date).getDate();swfobject.embedSWF(o,this.movieName,1,1,"9.0.0",this.options.flashCodeBase,this._getParameters(),{wmode:this.options.windowMode,allowScriptAccess:"always"})},jQueryAudioPlayer.prototype.init=function(){try{this.audioElement=document.createElement("audio")}catch(e){this.audioElement=null}if(!this._checkSupport()){if(!this.options.useFlashFallback)return void this._dispatchOnNotSupport();this.initFlashFallback()}this.controls=$(jQueryAudioPlayer.templates[this.options.template]),this.controls.addClass(this.options.cssTemplate),this.element.append(this.controls);var t=this;this.playButton=this.controls.find(".play"),this.audioElement&&(this.audioElement.preload="auto",this.audioElement.addEventListener("ended",function(){t.gotoNext()},!0),this.audioElement.addEventListener("playing",function(){t._setInfo(t.current)},!0),this.audioElement.addEventListener("waiting",function(){t.element.find(".artist-str").html(t.options.loadingStr),t.element.find(".title-str").html(t.options.loadingStr)},!0),this.audioElement.addEventListener("progress",function(e){var o=0;t.audioElement.duration&&t.audioElement.duration>0&&t.audioElement.buffered.length>0&&(o=parseInt(t.audioElement.buffered.end(0)/t.audioElement.duration*100,10)),t._setLoadedProgress(o)},!0),this.audioElement.addEventListener("timeupdate",function(e){var o=parseInt(t.audioElement.currentTime/t.audioElement.duration*100,10);t._setTimeProgress(o)},!0),this.audioElement.addEventListener("volumechange",function(e){t._volumeAdjustment()},!0),this.audioElement.addEventListener("load",function(e){e.target},!0),this.audioElement.addEventListener("error",function(e){e.target},!0),this.audioElement.addEventListener("loadedmetadata",function(e){var t=e.target;if("error"==e.type){e.target.error.code;console.error("error: "+t.currentSrc+", "+e.target.error.code)}},!0)),this.controls.find(".volume-area").on("touchstart",function(e){e=e.originalEvent;var o=e.touches[0].screenX,a=$(this).offset().left,n=($(this).offset().top,o-a),i=t.controls.find(".volume").width(),s=100*n/i;return s>100&&(s=100),0>s&&(s=0),t._setVolume(s/100),e.stopPropagation(),e.preventDefault(),!1}),this.controls.find(".volume-area").on("touchmove",function(e){e=e.originalEvent;var o=e.touches[0].screenX,a=$(this).offset().left,n=($(this).offset().top,o-a),i=t.controls.find(".volume").width(),s=100*n/i;return s>100&&(s=100),0>s&&(s=0),t._setVolume(s/100),e.stopPropagation(),e.preventDefault(),!1}),this.controls.find(".volume").click(function(e){var o=$(this).offset().left,a=$(this).offset().top,n=e.pageX-o,i=(e.pageY-a,t.controls.find(".volume").width()),s=100*n/i;s>100&&(s=100),0>s&&(s=0),t._setVolume(s/100)}),this.controls.find(".play").click(function(e){t.paused||t.stoped?t.play():t.pause()}),this.controls.find(".stop").click(function(){t.stop()}),this.controls.find(".previous").click(function(){t.gotoPrevious()}),this.controls.find(".next").click(function(){t.gotoNext()}),this.audioElement&&(this._setVolume(this.options.volume/100),this._loadPlaylist())},jQueryAudioPlayer.templates={"default":'<div id="main_player"><a href="javascript: void(0);" class="button back"></a><a href="javascript: void(0);" class="button play"></a><a href="javascript: void(0);" class="button stop"></a><a href="javascript: void(0);" class="button next"></a><span class="info"></span></div>',mini:'<div id="main_player"><a href="javascript: void(0);" class="button play"></a><a href="javascript: void(0);" class="button stop"></a><a href="javascript: void(0);" class="button back"></a><a href="javascript: void(0);" class="button next"></a><div class="seeker"><div class="loaded"><div class="progress"></div></div></div></div>',"new":'<div id="main_player"> 				<div class="line-up"> 			    	<div class="music-info"> 			    		<div class="title"> 			    			<span class="title-icon">&nbsp;</span> 			    			<span class="title-str"></span> 			    		</div> 			    		<div class="artist"> 			    			<span class="artist-icon">&nbsp;</span> 			    			<span class="artist-str"></span> 			    		</div> 			    	</div> 				    <div class="tracks"> 				    	<span class="current-track">0</span> 				    	&nbsp;/&nbsp; 				    	<span class="total-tracks">0</span> 				    </div> 				    <div class="controls"> 				    	<div class="previous-area"> 				    		<a class="previous" href="javascript: void(0);"></a> 				    	</div> 				    	<div class="play-area"> 				    		<a class="play" href="javascript: void(0);"></a> 				    	</div> 				    	<div class="next-area"> 				    		<a class="next" href="javascript: void(0);"></a> 				    	</div> 				    </div> 				</div> 			    <div class="line-bottom"> 			    	<div class="seeker-area"> 			    		<div class="seeker"> 			    			<div class="loaded"> 			    				<div class="progress"></div> 			    			</div> 			    		</div> 			    	</div> 			    	<div class="volume-area"> 			    		<span class="volume-icon">&nbsp;</span> 			    		<div class="volume"> 			    			<div class="volume-progress"></div> 			    		</div> 			    	</div> 			    </div> 			 </div>',player_custom:'<div id="main_player" class="main"> 				        <div class="info music-info"> 				            <p class="song title-str"><span></span></p> 				            <p class="artist artist-str"><span></span></p> 				        </div> 				        <div class="tracks"> 				        	<span class="current-track">0</span>/<span class="total-tracks">0</span> 				        </div> 				        <div class="control controls"> 				            <div class="nav prev previous"></div> 				            <div class="play-area"><div class="play play-pause"></div></div> 				            <div class="nav next"></div> 				        </div> 				        <div class="seeker-area"> 				        	<div class="seeker"> 				        	 <div class="bg-track"></div> 						        <div class="progress track "> 						            <div class="bar"> 						              <div class="drag"></div> 						            </div> 						        </div><!-- end .progress --> 						    </div> 						</div> 				        <div class="volume-icon"></div> 				        <div class="volume track"> 				            <div class="bar volume-progress"> 				              <div class="drag"></div> 				            </div> 				        </div><!-- end .valume --> 				        <div class="div-aux div-aux-1"></div> 				        <div class="div-aux div-aux-2"></div> 				        <div class="div-aux div-aux-3"></div><!-- divs auxiliares para elementos do skin --> 				    </div> ',mobile:'<ul class="playerMobile"> 					<li> 				    	<a href="#" class="prev previous"></a> 				    </li> 				    <li > 				    	<a href="#" class="playpause play play-pause"></a> 				    </li> 				    <li> 				    	<a href="#" class="next"></a> 				    </li> 				</ul> '},jQuery.extend(jQueryAudioPlayer,{DEFAULTS:{template:"default",cssTemplate:"default",autoPlay:!0,askToPlay:!1,volume:100,playlistUrl:"",playlist:"",element:"",onlyMobile:!1,onNotSupport:null,pauseaE:null,onPause:null,onPlay:null,onStop:null,useFlashFallback:!0,flashClassId:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",flashCodeBase:"http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab",basePath:"",windowMode:"transparent",loadingStr:"Carregando...",askTitleStr:"Ativar m\xfasica?",askStr:"Essa p\xe1gina possui um playlist musical. Deseja reproduzir enquanto navega?",askBtns:["Sim","N\xe3o"]}}),jQueryAudioPlayer.prototype.onInitPlugin=function(){this._setVolume(this.options.volume/100),this._loadPlaylist()},jQueryAudioPlayer.prototype.onProgress=function(e){this._setLoadedProgress(e)},jQueryAudioPlayer.prototype.onTimer=function(e,t){if(0!=e){var o=parseInt(t/e*100);this._setTimeProgress(o)}},jQueryAudioPlayer.prototype.onEnded=function(){this.gotoNext()},jQueryAudioPlayer.prototype.onPlaying=function(){this._setInfo(this.current)};