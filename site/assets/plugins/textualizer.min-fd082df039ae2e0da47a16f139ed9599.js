!function(e,t){function n(e){var n,a,i,r={};if(t.getComputedStyle)if(e=t.getComputedStyle(e,null),e.length)for(a=0,i=e.length;i>a;a++)n=e[a].replace(/\-([a-z])/,function(e,t){return t.toUpperCase()}),r[n]=e.getPropertyValue(e[a]);else for(n in e)"function"!=typeof e[n]&&"length"!==n&&(r[n]=e[n]);else for(n in e=e.currentStyle||e.style)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(){this.pos=this.domNode=this.character=null,this.visited=this.inserted=this.used=!1}function i(){this.str="",this.characterList=[]}var r,s=1e3,o=500,l=2e3,d=2e3,u="textualizer.changed";i.prototype={use:function(t){var n=null;return e.each(this.characterList,function(){return this.character!==t||this.used?void 0:(this.used=!0,n=this,!1)}),n},reset:function(){e.each(this.characterList,function(){this.used=this.inserted=!1})}},r=function(r,m,c){function h(n){var a=e.fn.textualizer.effects,i="random"===c.effect?a[Math.floor(Math.random()*(a.length-2))+1][1]:A,r=e.Deferred(),s=[];return e.each(n.characterList,function(n,a){if(!a.inserted){a.domNode.css({left:a.pos.left,top:a.pos.top});var r=e.Deferred();t.setTimeout(function(){i({item:a,container:w,dfd:r})},Math.random()*l),s.push(r)}}),e.when.apply(null,s).done(function(){r.resolve()}),r.promise()}function p(){g===C.length-1&&(e.each(y,function(e,t){t.reset()}),g=-1,c.loop||x.pause()),g++,f(g)}function f(n){if(!S){var l=e.Deferred(),m=y[n];if(!m){var f,g,_,w,x=[],A=new i;for(A.str=C[n],y.push(A),f=0,w=A.str.length;w>f;f++)g=A.str.charAt(f),""===g?k.append(" "):(_=new a,_.character=g,_.domNode=e("<span/>").text(g),k.append(_.domNode),x.push(_));var D=c.centered?(v-k.height())/2:0;e.each(x,function(e,t){t.pos=t.domNode.position(),t.domNode=t.domNode.clone(),t.pos.top+=D,t.domNode.css({left:t.pos.left,top:t.pos.top,position:"absolute"}),A.characterList.push(t)}),k.html(""),m=A}if(M){var j,T,x=M,H=m,I=[],N=[],$=e.Deferred();f=[function(t){return T=e.Deferred(),t.animate({top:b.bottom,opacity:"hide"},T.resolve),T.promise()},function(t){return T=e.Deferred(),t.fadeOut(1e3,T.resolve),T.promise()}],j=f[Math.floor(Math.random()*f.length)];var z;e.each(x.characterList,function(t,n){if(z=H.use(n.character))z.domNode=n.domNode,z.inserted=!0,I.push(z);else{var a=e.Deferred();N.push(a),j(n.domNode.delay(Math.random()*d)).done(function(){n.domNode.remove(),a.resolve()})}}),e.when.apply(null,N).done(function(){return $.resolve(I)}),$.promise().done(function(n){var a=m,i=e.Deferred(),r=[];t.setTimeout(function(){e.each(n,function(t,n){var a=e.Deferred();n.domNode.animate({left:n.pos.left,top:n.pos.top},c.rearrangeDuration,a.resolve),r.push(a.promise())}),e.when.apply(null,r).done(function(){t.setTimeout(function(){h(a).done(function(){i.resolve()})},o)})},s),i.promise().done(function(){l.resolve()})})}else h(m).done(function(){l.resolve()});M=m,l.promise().done(function(){r.trigger(u,{index:n}),t.setTimeout(p,c.duration)})}}var y,g,M,v,b,_,w,k,x=this,C=[],A=null,D=!1,S=!1;"random"!==c.effect&&e.each(e.fn.textualizer.effects,function(){return this[0]===c.effect?(A=this[1],!1):void 0}),_=r.clone().removeAttr("id").appendTo(t.document.body),_.css(n(r[0])),_.css({position:"absolute",top:"-1000px"}),k=e("<div />").css({position:"relative",visibility:"hidden"}).appendTo(_),r.css("overflow","hidden"),w=e("<div />").css("position","relative").appendTo(r),v=r.height(),b={bottom:v},this.data=function(e){this.stop(),C=e,y=[]},this.stop=function(){this.pause(),D=!1,M=null,g=0,w.empty(),k.empty()},this.pause=function(){S=!0,D=!1},this.start=function(){0===C.length||D||(g=g||0,D=!0,S=!1,f(g))},this.destroy=function(){w.parent().removeData("textualizer").end().remove(),k.remove()},m&&m instanceof Array&&this.data(m)},e.fn.textualizer=function(){var t,n,a,i=arguments;return a=this.data("textualizer"),a||(t=[],1===i.length&&i[0]instanceof Array?t=i[0]:1===i.length&&"object"==typeof i[0]?n=i[0]:2===i.length&&(t=i[0],n=i[1]),0===t.length&&this.find("p").each(function(){t.push(e(this).text())}),this.html(""),a=new r(this,t,e.extend({},e.fn.textualizer.defaults,n)),this.data("textualizer",a)),n=a,"string"==typeof i[0]&&n[i[0]]&&n[i[0]].apply(n,Array.prototype.slice.call(i,1)),this},e.fn.textualizer.defaults={effect:"random",duration:2e3,rearrangeDuration:1e3,centered:!1,loop:!0},e.fn.textualizer.effects=[["none",function(e){e.container.append(e.item.domNode.show())}],["fadeIn",function(e){return e.container.append(e.item.domNode.fadeIn(2e3,e.dfd.resolve)),e.dfd.promise()}],["slideLeft",function(e){return e.item.domNode.appendTo(e.container).css({left:-1e3}).show().animate({left:e.item.pos.left},2e3,e.dfd.resolve),e.dfd.promise()}],["slideTop",function(e){return e.item.domNode.appendTo(e.container).css({top:-1e3}).show().animate({top:e.item.pos.top},2e3,e.dfd.resolve),e.dfd.promise()}]]}(jQuery,window);